import{i as tt}from"./Segment.9483a1c5.js";import{lX as et,nX as nt,nY as at,d as F,hp as st,nZ as $,f as it,bt as rt,bv as ot,bw as ct,n_ as ht,n$ as ut,o0 as T,fS as j,c_ as C,aa as E}from"./index.860f6be5.js";import{u as lt}from"./colorUtils.d5f927cc.js";const At={readOnly:!0,get(){return tt(this.view)}};var G;(function(t){t[t.Auto=0]="Auto",t[t.Euclidean=1]="Euclidean",t[t.Geodesic=2]="Geodesic"})(G||(G={}));function O(t){if(!t)return null;if(et(t)&&t.wkid){const e=nt[t.wkid];if(e)return e}if(t.wkt){const e=ft(t.wkt);if(e)return e}return null}function ft(t){const e=at.exec(t);if(!e||e.length!==2)return null;const n=e[1].split(",");if(!n||n.length<3)return null;const a=parseFloat(n[1]),s=parseFloat(n[2]);return isNaN(a)||isNaN(s)?null:{a,f:s===0?0:1/s}}function pt(t){const e=O(t!=null?t:it.WGS84);if(Mt(e))return e;const n=e.a*(1-e.f);return Object.assign(e,{b:n,eSq:1-(n/e.a)**2,radius:(2*e.a+n)/3,densificationRatio:1e4/((2*e.a+n)/3)})}function Mt(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function mt(t){return O(t)!==null}function Nt(t,e="meters"){if(!t)throw new F("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(a=>!mt(a.spatialReference)))throw new F("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let a=0;a<t.length;a++){const s=t[a],{spatialReference:d}=s,g=s.type==="polyline"?s.paths:s.rings;let r=0;for(let v=0;v<g.length;v++){const o=g[v];let f=0;for(let p=1;p<o.length;p++){const w=o[p-1][0],z=o[p][0],R=o[p-1][1],h=o[p][1];if(R!==h||w!==z){const c=new dt;$t(c,[w,R],[z,h],d),f+=c.distance}}r+=f}r=st(r,"meters",e),n.push(r)}return n}class dt{constructor(e=0,n,a){this.distance=e,this.azimuth=n,this.reverseAzimuth=a}}function $t(t,e,n,a){const s=e[0]*$,d=e[1]*$,g=n[0]*$,r=n[1]*$,{a:v,b:o,f,radius:p}=pt(a),w=g-s,z=Math.atan((1-f)*Math.tan(d)),R=Math.atan((1-f)*Math.tan(r)),h=Math.sin(z),c=Math.cos(z),_=Math.sin(R),u=Math.cos(R);let k,b,M,i,A,S,N,P,U,y,x=1e3,l=w;do{if(N=Math.sin(l),P=Math.cos(l),M=Math.sqrt(u*N*(u*N)+(c*_-h*u*P)*(c*_-h*u*P)),M===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;A=h*_+c*u*P,S=Math.atan2(M,A),U=c*u*N/M,b=1-U*U,i=A-2*h*_/b,isNaN(i)&&(i=0),y=f/16*b*(4+f*(4-3*b)),k=l,l=w+(1-y)*f*U*(S+y*M*(i+y*A*(2*i*i-1)))}while(Math.abs(l-k)>1e-12&&--x>0);if(x===0){const J=p,K=Math.acos(Math.sin(d)*Math.sin(r)+Math.cos(d)*Math.cos(r)*Math.cos(g-s))*J,D=g-s,L=Math.sin(D)*Math.cos(r),Q=Math.cos(d)*Math.sin(r)-Math.sin(d)*Math.cos(r)*Math.cos(D),V=Math.atan2(L,Q);return t.azimuth=V/$,t.distance=K,t.reverseAzimuth=void 0,t}const m=b*(v*v-o*o)/(o*o),q=m/1024*(256+m*(m*(74-47*m)-128)),Z=o*(1+m/16384*(4096+m*(m*(320-175*m)-768)))*(S-q*M*(i+q/4*(A*(2*i*i-1)-q/6*i*(4*M*M-3)*(4*i*i-3)))),B=Math.atan2(u*Math.sin(l),c*_-h*u*Math.cos(l)),H=Math.atan2(c*Math.sin(l),c*_*Math.cos(l)-h*u);return t.azimuth=B/$,t.distance=Z,t.reverseAzimuth=H/$,t}function Pt(t,e){if(rt(e,0,0,0),t.length>0){for(let n=0;n<t.length;++n)ot(e,e,t[n]);ct(e,e,1/t.length)}}function Ut(t,e,n,a){a.projectToRenderScreen(t,X),a.projectToRenderScreen(e,I),ht(n,vt,gt),ut(n,n)}const X=T(),gt=X,I=T(),vt=I;class yt{constructor(e=null){this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=j(this._spatialReference,1),this._metersPerElevationUnit=j(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}function W(t,e){const n=t.a*e;return lt(t)>225?new E([0,0,0,n]):new E([255,255,255,n])}function Y(t,e){const n=new E(t);return n.a*=e,n}function _t(t=1){return Y(C.analysisTheme.accentColor,t)}function St(t=1){return W(_t(),t)}function wt(t=1){return Y(C.analysisTheme.textColor,t)}function qt(t=1){return W(wt(),t)}export{mt as M,wt as a,$t as b,Pt as c,At as d,G as e,Ut as f,_t as i,qt as s,yt as t,St as u,dt as v,Nt as y};
